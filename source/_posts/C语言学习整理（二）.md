title: C语言学习整理（二）
date: 2016-03-17 21:24:19
categories:
- C语言
tags:
- 笔记

---
前言：上一篇可能开篇，讲的东西过于浅显，还有我本来打算全都整理一下的，但是发现细小的细节太多，全都写出来也不现实，所以抓住主要的整理吧。

# 变量是什么
顾名思义，变量就是可以改变的量，与之相对应的就是常量，那么同样可以知道不能对常量做出修改。

那么常见的变量的类型有以下几种（64位编译器）：

| 名称 | 声明类型 | 所占字节数 | 
|----- |:------:|--------:|
| 整型 | int     | 4字节		|
|单精度浮点型|float|4字节		|
|双精度浮点型|double|8字节|
|字符|char|1字节|
|无符号整型|unsigned int|4字节|
|长整型|long int|8字节|
|指针类型|char*|8字节|
 
以上只是给出64位环境下字节数，随着编译器的不同，可能有的有的变化。C标准中并没有具体给出规定那个基本类型应该是多少字节数，而且这个也与机器、OS、编译器有关，比如同样是在32bits的操作系统系，VC++的编译器下int类型为占4个字节；而tuborC下则是2个字节。

# 变量的声明与定义

一般情况下，我们可以这样理解，在内存中开辟了空间称为**定义**，而不需要申请内存的称为**声明**。

准确的说的话。变量的声明（declaration）分为两种：

1. 一种是需要建立存储空间的。例如：我们在程序中写 int a； 那么在声明的时候就已经建立的存储空间了。这种声明是**定义性声明**，即我们平时说的**"定义"**。
2. 另一种是不需要建立存储空间的，只是告诉编译器某变量已经在别处定义过了。例如：我们在程序中写 extern int a；其中 extern 关键字就是告诉编译器变量a已经在别处定义过了。这种声明是**引用性声明**。即我们平时所说的***“声明"**。

我这样说可能有些人要晕了，觉得变量的声明和定义到底有什么区别。其实从广义角度上讲，**声明中包含着定义，而并非所有的声明都是定义**。也是说*定义性声明*既是定义又是声明，而*引用性声明*只是声明。

举个栗子：

```
int a;				//定义性声明，分配存储空间，初值不确定 

int b = 0;			//定义性声明，分配存储空间，赋初值

extern int c;		//引用性声明，不分配存储空间，只是告诉编译器变量c在别处定义了
```

最后一点在一个作用域中可以重复声明，但是不能重复定义。

# 变量的使用
变量只有定义了以后才能经行初始化，初始化后才可以调用，千万不能调用一个没有经过初始化的变量，最终的输出结果是不确定的。

变量的修改，可以修改变量的值，多次覆盖以赋值。使用占位符输出变量。


<!-- more -->
# 变量的作用域



作用域是指可以存取变量的代码范围。如果超出这个范围就不能取到变量的值。
一般的变量的作用域：从定义那一行开始一直到其所在的大括号的结束为止。

在相同的作用域内不可以有同名的变量，也就是上面说的重复定义问题。

在代码块的外部是不能访问代码块内部定义的变量。而代码块的内部是可以访问外部代码块定义的变量。因为在内部所有的变量都在外部的大括号下，所以可以访问。
如果内部代码块中定义了和外部代码块相同变量名的变量，那么在内部代码块中这个变量的作用域内，内部的变量会覆盖外部代码块所定义的变量。但是外部代码块中变量的值不受内部代码块的改变而改变。

```
int main(int argc, const char * argv[]) {

    int a = 10;
    printf("%d\n",a);
    {
        int a = 20;
      
        printf("%d\n",a);
    }

    printf("%d\n",a);
       return 0;
}

```

输出结果是：
10
20
10


说作用域之后我们再清楚下全局变量和局部变量。

- 局部变量：也称为内部变量。局部变量是在函数内作定义说明的。其作用域仅限于函数内， 离开该函数后再使用这种变量是非法的。

- 全局变量也称为外部变量，它是在函数外部定义的变量。 它不属于哪一个函数，它属于一个源程序文件。其作用域是整个源程序。


# 变量的存储类型

## 存储方式

变量的存储类型我们从变量的作用域（从空间上）角度来分，可以分为全局变量和局部变量。

从另外一个角度，从变量值存在的作用时间（即生存期）角度来分，可以分为静态存储和动态存储方式。

* 静态存储：是指在程序的运行期间分配固定的存储空间的方式。
* 动态存储：是在程序运行期间根据需要进行动态的分配存储空间的方式。

用户的存储空间可以分为3个部分：

* 程序区。
* 静态存储区。
* 动态存储区。

全局变量全部存放在静态存储区，在程序开始执行时给全局变量分配存储区，程序行完毕就释放。在程序执行过程中它们占据固定的存储单元，而不动态地进行分配和释放。



动态存储区存放以下数据：

* 函数形式参数；
* 自动变量（未加static声明的局部变量）；
* 函数调用实的现场保护和返回地址。

对以上这些数据，在函数开始调用时分配动态存储空间，函数结束时释放这些空间。

## 存储类别

在C语言中，每个变量和函数都有两个属性，数据类型和数据的存储类型。



### auto变量

函数中的局部变量，如不专门声明为static存储类别，都是动态地分配存储空间的，数据存储在动态存储区中。函数中的形参和在函数中定义的变量（包括在复合语句中定义的变量），都属此类，在调用该函数时系统会给它们分配存储空间，在函数调用结束时就自动释放这些存储空间。这类局部变量称为自动变量。自动变量用关键字auto作存储类别的声明。例如：
```
int f(int a){  /* 定义f函数，a为参数 */
    auto int b,c=3;  /*定义b，c自动变量*/
    /* …… */
}
```

一般的auto关键字我们不需要显示声明，都可以省略.

### static声明局部变量

**有时希望函数中的局部变量的值在函数调用结束后不消失而保留原值，这时就应该指定局部变量为“静态局部变量”，用关键字static进行声明。**

对静态局部变量的说明：

1. 静态局部变量属于静态存储类别，在静态存储区内分配存储单元。在程序整个运行期间都不释放。而自动变量（即动态局部变量）属于动态存储类别，占动态存储空间，函数调用结束后即释放。
2. 静态局部变量在编译时赋初值，即只赋初值一次；而对自动变量赋初值是在函数调用时进行，每调用一次函数重新给一次初值，相当于执行一次赋值语句。
3. 如果在定义局部变量时不赋初值的话，则对静态局部变量来说，编译时自动赋初值0（对数值型变量）或空字符（对字符变量）。而对自动变量来说，如果不赋初值则它的值是一个不确定的值。

### register变量

**为了提高效率，C语言允许将局部变量得值放在CPU中的寄存器中，这种变量叫“寄存器变量”，用关键字register作声明。**

对寄存器变量的几点说明：

* 只有局部自动变量和形式参数可以作为寄存器变量；
* 一个计算机系统中的寄存器数目有限，不能定义任意多个寄存器变量；
* 局部静态变量不能定义为寄存器变量。

### extern声明外部变量

如果在某个文件中想调用另一个文件中的变量，则必须声明该变量为外部变量，例如
：extern int a；a已经在另一个文件中定义，我们只需声明便可以使用。还有注意的一点是它的作用域为从变量定义处开始，到本程序文件的末尾。**如果你想在定义点之前的函数想引用该外部变量，则应该在引用之前用关键字extern对该变量作“外部变量声明”。**表示该变量是一个已经定义的外部变量。有了此声明，就可以从“声明”处起，合法地使用该外部变量。